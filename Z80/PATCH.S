STRPRN      EQU     1D28H       ;文字列表示 DE <- 先頭アドレス 終端は00H

			ORG		0D000H-6
			
			DW		END_P-START
			DW		START
			DW		START

START:		LD		HL,0E800H
			LD		A,(HL)
			CP		0C3H
			JR		NZ,PF1
			INC		HL
			LD		A,(HL)
			CP		0DFH
			JR		NZ,PF1
			INC		HL
			LD		A,(HL)
			CP		0EDH
			JR		NZ,PF1
			LD		HL,0EDDFH
			LD		(HL),0C3H
			LD		HL,0EFEAH
			LD		(0EDE0H),HL
			LD		HL,PATCH2
			LD		DE,0EFEAH
			LD		BC,PATHC2_END-PATCH2
			LDIR
			LD      DE,MSG2_PATCH
			CALL    STRPRN
			RET

PATCH2:		CALL	0EB75H
			CALL	0E953H
			JP		0EDE2H
PATHC2_END:

MSG2_PATCH:	DB		'BOOTE8 PATCH OK!',0AH,0DH,00H

PF1:
			LD		HL,0F800H
			LD		A,(HL)
			CP		0C3H
			RET		NZ
			INC		HL
			LD		A,(HL)
			CP		0DFH
			RET		NZ
			INC		HL
			LD		A,(HL)
			CP		0FDH
			RET		NZ

			LD		HL,0FDDFH
			LD		(HL),0C3H
			LD		HL,0FFF4H
			LD		(0FDE0H),HL
			LD		HL,PATCH
			LD		DE,0FFF4H
			LD		BC,PATHC_END-PATCH
			LDIR
			LD      DE,MSG_PATCH
			CALL    STRPRN
			RET

PATCH:		CALL	0FB75H
			CALL	0F953H
			JP		0FDE2H
PATHC_END:

MSG_PATCH:	DB		'BOOTF8 PATCH OK!',0AH,0DH,00H

END_P:
			END